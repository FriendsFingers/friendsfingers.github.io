"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};Function.prototype.$asyncbind=function a(b,c){"use strict";function d(){return e.apply(b,arguments)}Function.prototype.$asyncbind||Object.defineProperty(Function.prototype,"$asyncbind",{value:a,enumerable:!1,configurable:!0,writable:!0}),a.trampoline||(a.trampoline=function(a,b,c,d,e){return function f(g){for(;g;){if(g.then)return g=g.then(f,d),e?void 0:g;try{if(g.pop){if(g.length)return g.pop()?b.call(a):g;g=c}else g=g.call(a)}catch(a){return d(a)}}}}),a.LazyThenable||(a.LazyThenable=function(){function a(a){return a&&a instanceof Object&&"function"==typeof a.then}function b(c,d,e){try{var f=e?e(d):d;if(c===f)return c.reject(new TypeError("Promise resolution loop"));a(f)?f.then(function(a){b(c,a)},function(a){c.reject(a)}):c.resolve(f)}catch(a){c.reject(a)}}function c(){}function d(){}function e(d,e){var f=new c;try{this._resolver(function(c){return a(c)?c.then(d,e):b(f,c,d)},function(a){b(f,a,e)})}catch(a){b(f,a,e)}return f}function f(a){this._resolver=a,this.then=e}return c.prototype={resolve:d,reject:d,then:function(a,b){this.resolve=a,this.reject=b}},f.resolve=function(a){return f.isThenable(a)?a:{then:function(b){return b(a)}}},f.isThenable=a,f}(),a.EagerThenable=a.Thenable=(a.EagerThenableFactory=function(a){function b(a){if(a){var b=this;a(function(a){b.resolve(a)},function(a){b.reject(a)})}}function c(a,b){if("function"==typeof a.y)try{var c=a.y.call(void 0,b);a.p.resolve(c)}catch(b){a.p.reject(b)}else a.p.resolve(b)}function d(a,b){if("function"==typeof a.n)try{var c=a.n.call(void 0,b);a.p.resolve(c)}catch(b){a.p.reject(b)}else a.p.reject(b)}a=a||"object"===("undefined"==typeof process?"undefined":_typeof(process))&&process.nextTick||"function"==typeof setImmediate&&setImmediate||function(a){setTimeout(a,0)};var e=function(){function b(){for(;c.length-d;){try{c[d]()}catch(a){}c[d++]=void 0,d===e&&(c.splice(0,e),d=0)}}var c=[],d=0,e=1024;return function(e){c.push(e),1==c.length-d&&a(b)}}();return b.prototype={resolve:function(a){if(void 0===this.state){if(a===this)return this.reject(new TypeError("Attempt to resolve promise with self"));var b=this;if(a&&("function"==typeof a||"object"===("undefined"==typeof a?"undefined":_typeof(a))))try{var d=0,f=a.then;if("function"==typeof f)return void f.call(a,function(a){d++||b.resolve(a)},function(a){d++||b.reject(a)})}catch(a){return void(d||this.reject(a))}this.state=c,this.v=a,b.c&&e(function(){for(var d=0,e=b.c.length;d<e;d++)c(b.c[d],a)})}},reject:function(a){if(void 0===this.state){this.state=d,this.v=a;var b=this.c;b&&e(function(){for(var c=0,e=b.length;c<e;c++)d(b[c],a)})}},then:function(c,d){var f=new b,g={y:c,n:d,p:f};if(void 0===this.state)this.c?this.c.push(g):this.c=[g];else{var h=this.state,i=this.v;e(function(){h(g,i)})}return f}},b.resolve=function(a){if(a&&a instanceof b)return a;var c=new b;return c.resolve(a),c},b.reject=function(a){if(a&&a instanceof b)return a;var c=new b;return c.reject(a),c},b.version="2.3.3-nodent",b})());var e=this;return!0===c?new a.Thenable(d):0===c?new a.LazyThenable(d):void 0===c?(d.then=d,d):function(){try{return e.apply(b,arguments)}catch(a){return c(a)}}};function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d("next",a)},function(a){d("throw",a)})}return d("next")})}}var App={web3:null,web3Provider:null,metamask:{installed:!1,netId:null},contracts:{},init:function(){App.initWeb3(!0)},initWeb3:function(a){a&&"undefined"!=typeof web3?(App.web3Provider=web3.currentProvider,App.web3=new Web3(App.web3Provider),App.metamask.installed=!0,App.web3.version.getNetwork(function(a,b){App.metamask.netId=b,b!==networkId&&App.initWeb3(!1)})):(App.web3Provider=new Web3.providers.HttpProvider(web3Provider),App.web3=new Web3(App.web3Provider))},initBuilder:function(){var a=_asyncToGenerator(function*(){return yield $.getJSON(abiPath+"FriendsFingersBuilder.json",function(a){App.contracts.FriendsFingersBuilder=TruffleContract(a),App.contracts.FriendsFingersBuilder.setProvider(App.web3Provider)})});return function(){return a.apply(this,arguments)}}(),initCrowdsale:function(){var a=_asyncToGenerator(function*(){return yield $.getJSON(abiPath+"FriendsFingersCrowdsale.json",function(a){App.contracts.FriendsFingersCrowdsale=TruffleContract(a),App.contracts.FriendsFingersCrowdsale.setProvider(App.web3Provider)})});return function(){return a.apply(this,arguments)}}(),initToken:function(){var a=_asyncToGenerator(function*(){return $.getJSON(abiPath+"FriendsFingersToken.json",function(a){App.contracts.FriendsFingersToken=TruffleContract(a),App.contracts.FriendsFingersToken.setProvider(App.web3Provider)})});return function(){return a.apply(this,arguments)}}(),home:function(){var a=_asyncToGenerator(function*(a){App.init(),yield App.initCrowdsale(),new Vue({el:"#top-head",data:{contract:null,crowdsale:{cap:0,weiRaised:0}},methods:{switchModule:function(){var b=_asyncToGenerator(function*(){if(this.crowdsale.hasStarted){$(".timer").addClass("d-none"),$("#top-head").removeClass("d-none");var b=yield App.contracts.FriendsFingersCrowdsale.at(a);this.crowdsale.cap=App.web3.fromWei((yield b.cap())).valueOf(),this.getRaised();var c=this;setInterval(function(){c.getRaised()},5e3)}else new TimezZ(".j-timer",{date:"February 24, 2018 12:00:00",daysName:"DD",hoursName:"HH",minutesName:"MM",secondsName:"SS",tagNumber:"div",tagLetter:"div",stop:!1}),this.timeCheck()});return function(){return b.apply(this,arguments)}}(),timeCheck:function(){if(this.crowdsale.hasStarted=Date.now()>this.crowdsale.startTime,!this.crowdsale.hasStarted){var a=this;setTimeout(function(){a.timeCheck()},1e3)}else this.switchModule()},getRaised:function(){var b=_asyncToGenerator(function*(){var b=yield App.contracts.FriendsFingersCrowdsale.at(a);this.crowdsale.weiRaised=App.web3.fromWei((yield b.weiRaised())).valueOf()});return function(){return b.apply(this,arguments)}}()},created:function(){var a=_asyncToGenerator(function*(){this.crowdsale.startTime=1519470000000,this.crowdsale.hasStarted=Date.now()>this.crowdsale.startTime,this.switchModule()});return function(){return a.apply(this,arguments)}}()})});return function(){return a.apply(this,arguments)}}(),bountyProgram:function(){var a=_asyncToGenerator(function*(){App.init(),Vue.use(VeeValidate),new Vue({el:"#bounty-program",data:{address_error:!1,copied:!1,wallet:"",email:"",telegram:"",postlink:""},methods:{subscribeBounty:function(){this.address_error=""!==this.wallet&&!App.web3.isAddress(this.wallet);this.address_error||this.$validator.validateAll().then(function(a){a?$("#mc-embedded-subscribe-form").submit():console.log("some errors")})},copyLink:function(){if(""!==this.wallet&&!this.address_error){document.querySelector("#mce-LINK").select();try{this.copied=document.execCommand("copy")}catch(a){this.copied=!1}}}},computed:{generateLink:function(){return this.address_error=""!==this.wallet&&!App.web3.isAddress(this.wallet),""===this.wallet||this.address_error?"":"https://www.friendsfingers.com/?utm_campaign=bounty&utm_source="+this.wallet}}})});return function(){return a.apply(this,arguments)}}(),viewCrowdsale:function(){var a=_asyncToGenerator(function*(a){App.init(),Vue.use(VeeValidate),yield App.initCrowdsale(),yield App.initToken(),new Vue({el:"#crowdsale-details",data:{qrcodeVisible:!1,copied:!1,usAgreement:!1,countryAgreement:!1,globalAgreement:!1,funds:1,txHash:"",makingTransaction:!1,crowdsale:{cap:0,goal:0,weiRaised:0,soldTokens:0,rate:0,investorCount:0,startTime:0,endTime:0,hasStarted:!1,hasEnded:!0,paused:!0,projectInfo:{}},token:{crowdsaleSupply:0}},created:function(){var b=_asyncToGenerator(function*(){var b=yield App.contracts.FriendsFingersCrowdsale.at(a),c=yield App.contracts.FriendsFingersToken.at((yield b.token()));this.token.address=c.address,this.token.name=yield c.name(),this.token.symbol=yield c.symbol(),this.token.decimals=(yield c.decimals()).valueOf(),this.crowdsale.address=b.address,this.crowdsale.cap=App.web3.fromWei((yield b.cap())).valueOf(),this.crowdsale.goal=App.web3.fromWei((yield b.goal())).valueOf(),this.crowdsale.weiRaised=App.web3.fromWei((yield b.weiRaised())).valueOf(),this.crowdsale.rate=(yield b.rate()).valueOf(),this.crowdsale.soldTokens=App.web3.toWei(this.crowdsale.weiRaised)*this.crowdsale.rate/Math.pow(10,this.token.decimals),this.crowdsale.investorCount=(yield b.investorCount()).valueOf(),this.crowdsale.startTime=1e3*(yield b.startTime()).valueOf(),this.crowdsale.startTimeFormatted=new Date(this.crowdsale.startTime).toLocaleString(),this.crowdsale.endTime=1e3*(yield b.endTime()).valueOf(),this.crowdsale.endTimeFormatted=new Date(this.crowdsale.endTime).toLocaleString(),this.crowdsale.projectInfo=JSON.parse((yield b.crowdsaleInfo())),this.crowdsale.hasStarted=Date.now()>this.crowdsale.startTime,this.crowdsale.hasEnded=yield b.hasEnded(),this.crowdsale.paused=yield b.paused(),this.token.crowdsaleSupply=this.crowdsale.cap*this.crowdsale.rate,$(".crowdsale-box").toggleClass("d-none")});return function(){return b.apply(this,arguments)}}(),methods:{viewQRCode:function(){if(!this.qrcodeVisible){var a=document.getElementById("crowdsale-qrcode");new QRCode(a,this.crowdsale.address),this.qrcodeVisible=!0}},copyAddress:function(){if(""!==this.wallet&&!this.address_error){document.querySelector("#crowdsale-address").select();try{this.copied=document.execCommand("copy")}catch(a){this.copied=!1}}},fundCrowdsale:function(){var b=_asyncToGenerator(function*(){var b=this;return App.metamask.installed?App.metamask.netId===networkId?void this.$validator.validateAll().then(function(){var c=_asyncToGenerator(function*(c){if(c){var d=yield App.contracts.FriendsFingersCrowdsale.at(a),e=App.web3.toWei(b.funds);try{b.txHash="",b.makingTransaction=!0;var f=yield d.send(e);b.txHash=f.tx,console.log(f)}catch(a){alert("Some error occurred. Maybe you rejected the transaction or you have MetaMask locked!"),b.makingTransaction=!1}}else console.log("some errors")});return function(){return c.apply(this,arguments)}}()):void alert("Your MetaMask extension in on the wrong network. Please switch on "+networkName+" and try again!"):void alert("To use the invest button please install MetaMask extension for Chrome or Firefox!")});return function(){return b.apply(this,arguments)}}()}})});return function(){return a.apply(this,arguments)}}()};(function(){"use strict";switch(page){case"bounty-program":App.bountyProgram();break;case"shaka-token-sale":App.viewCrowdsale(FriendsFingersTokenSaleAddress);break;case"crowdsale":var a=window.location.pathname.split("/");"undefined"!=typeof a[2]&&""!==a[2]?App.viewCrowdsale(a[2]):window.location.href=window.location.origin+"/not-found";break;default:App.home(FriendsFingersTokenSaleAddress);}})(jQuery);